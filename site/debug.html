<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Debug Data Loading</title>
</head>
<body>
    <h1>Data Loading Debug</h1>
    <div id="status">Testing data loading...</div>
    <pre id="output"></pre>
    
    <script>
        const output = document.getElementById('output');
        const status = document.getElementById('status');
        
        async function testDataLoading() {
            const results = [];
            
            // Test 1: Check if we can fetch tools.json
            try {
                const response = await fetch('data/tools.json');
                results.push(`Fetch tools.json: ${response.ok ? 'SUCCESS' : 'FAILED'} (${response.status})`);
                if (response.ok) {
                    const data = await response.json();
                    results.push(`Tools data: ${data.tools ? data.tools.length + ' tools loaded' : 'No tools array'}`);
                    results.push(`Data structure: ${JSON.stringify(Object.keys(data))}`);
                }
            } catch (e) {
                results.push(`Fetch error: ${e.message}`);
            }
            
            // Test 2: Check other data files
            const files = ['categories.json', 'stats.json', 'summary.json'];
            for (const file of files) {
                try {
                    const response = await fetch(`data/${file}`);
                    results.push(`Fetch ${file}: ${response.ok ? 'SUCCESS' : 'FAILED'} (${response.status})`);
                } catch (e) {
                    results.push(`Fetch ${file} error: ${e.message}`);
                }
            }
            
            // Test 3: Check if DataLoader exists
            results.push(`\nwindow.DataLoader exists: ${typeof window.DataLoader !== 'undefined'}`);
            
            // Test 4: Check current location
            results.push(`\nCurrent protocol: ${window.location.protocol}`);
            results.push(`Current host: ${window.location.host}`);
            results.push(`Current pathname: ${window.location.pathname}`);
            
            // Test 5: Try loading with DataLoader if it exists
            if (typeof window.DataLoader !== 'undefined') {
                try {
                    const loader = new window.DataLoader();
                    results.push('\nTrying DataLoader.loadAll()...');
                    const data = await loader.loadAll();
                    results.push(`DataLoader result: ${data.tools ? data.tools.length + ' tools' : 'No tools'}`);
                } catch (e) {
                    results.push(`DataLoader error: ${e.message}`);
                }
            }
            
            output.textContent = results.join('\n');
            status.textContent = 'Debug complete';
        }
        
        // Load DataLoader first
        const script = document.createElement('script');
        script.src = 'js/data-loader.js';
        script.onload = () => {
            testDataLoading();
        };
        script.onerror = () => {
            output.textContent = 'Failed to load data-loader.js';
        };
        document.head.appendChild(script);
    </script>
</body>
</html>